<UserControl x:Class="SystemPult.PultView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:iop="clr-namespace:IOPanelControl;assembly=IOPanelControl"
             xmlns:local="clr-namespace:SystemPult"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:controls="clr-namespace:MahApps.Metro;assembly=MahApps.Metro"
             xmlns:pi="clr-namespace:ProberInterfaces;assembly=ProberInterfaces"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:MVVM="clr-namespace:MVVMBehavior"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" >
    <UserControl.Resources>
        <!--<DataTemplate x:Key="IOStatusLabelTemplate">
            <Grid>
                <Label BorderBrush="{Binding Value}"
            </Grid>
        </DataTemplate>-->
        <local:PortStateToColorCon x:Key="PortToColorConv"/>
        <local:PortTypeToColorCon x:Key="PortTypeToColorConv"/>
    </UserControl.Resources>
    <Grid>
        <TabControl>
            <TabItem Header="ADDRESS">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="3*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="80*"/>
                        <!--<RowDefinition Height="8*"/>-->
                    </Grid.RowDefinitions>
                    <ListBox Grid.Row="0" ItemsSource="{Binding Pathlist}" SelectedIndex="{Binding SelectIdx}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid Height="75">

                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <!--<RowDefinition/>-->
                                    </Grid.RowDefinitions>

                                    <Grid Grid.Row="0">

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>

                                        <TextBox  Grid.Column="0" Width="400" Margin="4" Text="{Binding Path}"
                                      IsEnabled="False"/>
                                        <Button   Grid.Column="1" Width="100" Margin="4" Content="Find" Command="{Binding FindPathCommand}"/>

                                    </Grid>

                                    <!--<Grid Grid.Row="1">

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <StackPanel Orientation="Horizontal">
                                                <Label >No .:</Label>
                                                <TextBox VerticalAlignment="Center" Width="Auto" Text="{Binding CellNum}"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <StackPanel Grid.Column="1">
                                            <StackPanel Orientation="Horizontal">
                                                <Label >Turn On :</Label>
                                                <TextBox VerticalAlignment="Center" Width="Auto" Text="{Binding IsConnected}"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <StackPanel Grid.Column="2">
                                            <StackPanel Orientation="Horizontal">
                                                <Label >Accessible :</Label>
                                                <TextBox VerticalAlignment="Center" Width="Auto" Text="{Binding Accessible}"/>
                                            </StackPanel>
                                        </StackPanel>

                                    </Grid>-->

                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <Grid Grid.Column="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <Button Grid.Row="0" Margin="8" Content="Initial" Command="{Binding InitCommand}"/>
                            <!--Button Grid.Row="1" Margin="8" Content="Find" Command="{Binding AddExecuteItemCommand}"/-->

                            <!--<StackPanel Grid.Row="3">
                    <StackPanel Orientation="Horizontal">
                        <Label >Floor</Label>
                        <TextBox VerticalAlignment="Center" Width="100"></TextBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <Label >C Class</Label>
                        <TextBox VerticalAlignment="Center" Width="100"></TextBox>
                    </StackPanel>
                </StackPanel>-->
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="IO">
                <Grid AllowDrop="True" DragEnter="ItemsControl_DragEnter" MVVM:DropBehavior.PreviewDropCommand="{Binding AddPortViewCommand}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>
                    <Border BorderThickness="0,0,1,0" Margin="4" BorderBrush="WhiteSmoke"/>
                    <Grid  Background="DimGray" Margin="8">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto" MinHeight="32"/>
                        </Grid.RowDefinitions>
                        <ItemsControl ItemsSource="{Binding SelectedPorts}" Margin="4" Grid.Row="0" 
                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Label BorderThickness="1" VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                                        BorderBrush="{Binding Value, Converter={StaticResource PortToColorConv}}" 
                                        Foreground="{Binding Value, Converter={StaticResource PortToColorConv}}" 
                                        Content="{Binding Key.Value}"  Height="32" Width="128" Margin="2"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Background="DimGray"></WrapPanel>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.Style>
                                <Style x:Name="EmptyItemControlStyle" TargetType="ItemsControl">
                                    <Style.Triggers>
                                        <Trigger Property="HasItems" Value="False">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                            <TextBlock  Text="Drag And Drop To Add Ports" FontWeight="Bold" FontSize="16"
                                                            HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ItemsControl.Style>
                        </ItemsControl>
                        <Button HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                            Margin="8" MinWidth="24" MinHeight="24" Grid.Row="0" ToolTip="Click To Clear"
                        Style="{x:Null}"  Command="{Binding ResetSelectedPorts}" BorderThickness="0"  Background="Transparent">
                            <materialDesign:PackIcon Kind="Nuke" Height="24" Width="24" Foreground="White" Background="Transparent"/>
                        </Button>
                        <ItemsControl ItemsSource="{Binding IOChannels}" Margin="4" Grid.Row="1" 
                                    Background="LightGray" 
                                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="{Binding ChannelIndex}" FontWeight="Bold" FontSize="16" 
                                               Foreground="{Binding IOType, Converter={StaticResource PortTypeToColorConv}}"
                                               ToolTip="{Binding IOType}"/>
                                        <Grid  Grid.Column="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Rectangle Grid.Column="15" Margin="1" Fill="{Binding Port[0].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="14" Margin="1" Fill="{Binding Port[1].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="13" Margin="1" Fill="{Binding Port[2].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="12" Margin="1" Fill="{Binding Port[3].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="11" Margin="1" Fill="{Binding Port[4].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="10" Margin="1" Fill="{Binding Port[5].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="9" Margin="1" Fill="{Binding Port[6].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="8" Margin="1" Fill="{Binding Port[7].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="7" Margin="1" Fill="{Binding Port[8].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="6" Margin="1" Fill="{Binding Port[9].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="5" Margin="1" Fill="{Binding Port[10].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="4" Margin="1" Fill="{Binding Port[11].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="3" Margin="1" Fill="{Binding Port[12].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="2" Margin="1" Fill="{Binding Port[13].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="1" Margin="1" Fill="{Binding Port[14].PortVal, Converter={StaticResource PortToColorConv}}"/>
                                            <Rectangle Grid.Column="0" Margin="1" Fill="{Binding Port[15].PortVal, Converter={StaticResource PortToColorConv}}"/>

                                            <Label Grid.Column="0" Content="16" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="1" Content="15" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="2" Content="14" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="3" Content="13" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="4" Content="12" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="5" Content="11" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="6" Content="10" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="7" Content="9" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="8" Content="8" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="9" Content="7" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="10" Content="6" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="11" Content="5" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="12" Content="4" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="13" Content="3" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="14" Content="2" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label Grid.Column="15" Content="1" FontWeight="Bold" FontSize="8" Foreground="DimGray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Vertical"></StackPanel>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>
                    </Grid>
                    <Grid Grid.Column="1">

                        <TabControl>
                            <TabItem Header="STAGE, LOADER">

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <Label Content="Inputs" FontSize="22" FontWeight="Bold" Grid.Column="0" Foreground="WhiteSmoke"/>
                                    <Label Content="Outputs" FontSize="22" FontWeight="Bold" Grid.Column="1" Foreground="WhiteSmoke"/>

                                    <Grid Grid.Row="2" Grid.Column="0" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <materialDesign:PackIcon Kind="AccountSearch" Margin="0 0 8 0" 
                                         Foreground="WhiteSmoke"
                                         VerticalAlignment="Center" Height="32" Width="32"/>
                                        <TextBox materialDesign:HintAssist.Hint="Search keyword for Inputs" Grid.Column="1"
                         Text="{Binding Path=InSearchKeyword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.IsFloating="True"
                         Margin="4" VerticalAlignment="Center" Foreground="White" HorizontalAlignment="Stretch">
                                        </TextBox>
                                    </Grid>
                                    <Grid Grid.Row="2" Grid.Column="1" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <materialDesign:PackIcon Kind="AccountSearch" Margin="0 0 8 0" 
                                         Foreground="WhiteSmoke"
                                         VerticalAlignment="Center" Height="32" Width="32"/>
                                        <TextBox materialDesign:HintAssist.Hint="Search keyword for Outputs" Grid.Column="1"
                         Text="{Binding Path=OutSearchKeyword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.IsFloating="True"
                         Margin="4" VerticalAlignment="Center" Foreground="White" HorizontalAlignment="Stretch">
                                        </TextBox>
                                    </Grid>
                                    <iop:UcIOPanel Grid.Row="1" Grid.Column="0"  
                           IOPorts="{Binding GPInputs}" 
                           FilteredPorts="{Binding InFilteredPorts}"
                           SearchKeyword="{Binding InSearchKeyword}"/>
                                    <iop:UcIOPanel Grid.Row="1" Grid.Column="1"  
                           IOPorts="{Binding GPOutputs}" 
                           FilteredPorts="{Binding OutFilteredPorts}"
                           SearchKeyword="{Binding OutSearchKeyword}" />
                                </Grid>

                            </TabItem>

                            <TabItem Header="FOUP" IsSelected="{Binding DisplayFoupIOTab, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <Label Content="Inputs" FontSize="22" FontWeight="Bold" Grid.Column="0" Foreground="WhiteSmoke"/>
                                    <Label Content="Outputs" FontSize="22" FontWeight="Bold" Grid.Column="1" Foreground="WhiteSmoke"/>

                                    <Grid Grid.Row="2" Grid.Column="0" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <materialDesign:PackIcon Kind="AccountSearch" Margin="0 0 8 0" 
                                         Foreground="WhiteSmoke"
                                         VerticalAlignment="Center" Height="32" Width="32"/>
                                        <TextBox materialDesign:HintAssist.Hint="Search keyword for Inputs" Grid.Column="1"
                         Text="{Binding Path=InSearchKeyword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.IsFloating="True"
                         Margin="4" VerticalAlignment="Center" Foreground="White" HorizontalAlignment="Stretch">
                                        </TextBox>
                                    </Grid>
                                    
                                    <Grid Grid.Row="2" Grid.Column="1" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <materialDesign:PackIcon Kind="AccountSearch" Margin="0 0 8 0" 
                                         Foreground="WhiteSmoke"
                                         VerticalAlignment="Center" Height="32" Width="32"/>
                                        <TextBox materialDesign:HintAssist.Hint="Search keyword for Outputs" Grid.Column="1"
                         Text="{Binding Path=OutSearchKeyword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.IsFloating="True"
                         Margin="4" VerticalAlignment="Center" Foreground="White" HorizontalAlignment="Stretch">
                                        </TextBox>
                                    </Grid>
                                    
                                    <iop:UcIOPanel Grid.Row="1" Grid.Column="0"  
                           IOPorts="{Binding GP_Foup_Inputs}" 
                           FilteredPorts="{Binding InFilteredFoupPorts}"
                           SearchKeyword="{Binding InSearchKeyword}"/>
                                    <iop:UcIOPanel Grid.Row="1" Grid.Column="1"  
                           IOPorts="{Binding GP_Foup_Outputs}" 
                           FilteredPorts="{Binding OutFilteredFoupPorts}"
                           SearchKeyword="{Binding OutSearchKeyword}" />
                                </Grid>
                                
                            </TabItem>
                        </TabControl>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Vision">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Border BorderBrush="DimGray" BorderThickness="1" Margin="7"/>
                    <!--<vd:DisplayPort Margin="8" AssignedCamera="{Binding ViewCamera}"/>-->
                    <ContentControl Content="{Binding CamViewPort}" Margin="8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                    <Grid Grid.Column="1" Margin="4">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <ItemsControl ItemsSource="{Binding AttatchedCameras}" Tag="{Binding .}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Button Content="{Binding Param.ChannelType.Value}" MinWidth="128" Height="36" Margin="8,4" HorizontalAlignment="Stretch"
                                                Command="{Binding Path=DataContext.SetCameraViewCommand, 
                                                                  RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" 
                                                CommandParameter="{Binding }"/>
                                        <ItemsControl ItemsSource="{Binding LightsChannels}" Grid.Row="1">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Label Content="{Binding Type.Value}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center"/>
                                                    </Grid>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <!--<WrapPanel HorizontalAlignment="Stretch"></WrapPanel>-->
                                                    <UniformGrid></UniformGrid>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </ItemsControl>
                                        <ItemsControl ItemsSource="{Binding LightModules}" Grid.Row="2">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*"/>
                                                            <!--<RowDefinition Height="Auto"/>-->
                                                        </Grid.RowDefinitions>
                                                        <Slider Grid.Row="1"  Width="150" HorizontalAlignment="Center"
                                                                TickPlacement="BottomRight" Orientation="Horizontal" 
                                                                Minimum="1" Maximum="255"
                                                                IsSnapToTickEnabled="True" TickFrequency="25" 
                                                                Value="{Binding CurLightValue, Mode=OneWayToSource}" >
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName="ValueChanged">
                                                                    <i:InvokeCommandAction Command="{Binding Path=DataContext.SetLightValueCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}"
                                                                                           CommandParameter="{Binding }"/>
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </Slider>
                                                        <!--<Label Content="{Binding Path=Tag.Value, RelativeSource={RelativeSource  AncestorType={x:Type ItemsControl}}}"/>-->
                                                    </Grid>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <!--<WrapPanel HorizontalAlignment="Stretch"></WrapPanel>-->
                                                    <UniformGrid></UniformGrid>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </ItemsControl>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <!--<WrapPanel></WrapPanel>-->
                                    <UniformGrid></UniformGrid>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>

                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="MOTION">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2.0*"/>
                        <ColumnDefinition Width="1.5*"/>
                        <!--<ColumnDefinition Width="1*"/>-->
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="1*"/>
                        <RowDefinition Height="1*"/>
                    </Grid.RowDefinitions>
                    <local:StagePanel Grid.Column="0" Grid.Row="0"/>
                    <local:LoaderPanel Grid.Column="0" Grid.Row="1"/>
                    <local:AuxilaryPosPage Grid.Column="1" Grid.Row="0"/>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>
