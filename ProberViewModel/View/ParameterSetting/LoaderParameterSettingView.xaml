<UserControl x:Class="LoaderParameterSettingView.LoaderParameterSettingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vc="clr-namespace:ValueConverters;assembly=ValueConverters"      
             xmlns:MahAppsControls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
             xmlns:local="clr-namespace:LoaderParameterSettingView"
             xmlns:System="clr-namespace:System;assembly=mscorlib"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:Bits_enum="clr-namespace:System.IO.Ports;assembly=System"
             xmlns:Communication_enum="clr-namespace:ProberInterfaces.Communication;assembly=ProberInterfaces"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" MaxHeight="1080" MaxWidth="1920" Background="Black"  >
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!--<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />-->
            </ResourceDictionary.MergedDictionaries>
            <vc:LoaderParamSettingViewIndexConverter x:Key="IndexConverter" />
            <local:SubstrateConverter x:Key="SubstrateConv" />
            <local:RFIDObjectChangeConveter x:Key="RFIDObjectChangeConv" />
            <local:BCDObjectChangeConveter x:Key="BCDObjectChangeConv"/>
            <local:RFIDProtocolTypeToIsEnableConverter x:Key="RFIDProtocolTypeToIsEnableConv" />
            <local:SerialPortList x:Key="SerialPortList" />
            <vc:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" True="Collapsed" False="Visible"/>
            <vc:CassetteIDValueConverter x:Key="CassetteIDValueConv" />
            <ObjectDataProvider x:Key="getModuleCommType" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="Communication_enum:EnumCommmunicationType"/>
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
            <ObjectDataProvider x:Key="getStopBitsEnum" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="Bits_enum:StopBits"/>
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
            <ObjectDataProvider x:Key="getModuleCommTypeBCD" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="Communication_enum:EnumCommmunicationType"/>
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>

        <StackPanel Orientation="Vertical">

            <MahAppsControls:MetroAnimatedSingleRowTabControl BorderThickness="1" BorderBrush="Black" Width="auto" MaxHeight="860" Height="auto" Background="Black">
                <TabControl.Resources>
                    <Style TargetType="{x:Type TabItem}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type TabItem}">
                                    <Grid>
                                        <Border Name="Border" Background="#FF6E6C67"  BorderBrush="Black" >
                                            <ContentPresenter x:Name="ContentSite" ContentSource="Header" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter TargetName="ContentSite" Property="Width" Value="30" />
                                            <Setter TargetName="Border" Property="Background" Value="#FFD4D0C8" />
                                        </Trigger>
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter TargetName="Border" Property="Background" Value="#FF6E6C67" />
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="true">
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="Background" Value="#FF6E6C67" />
                        <Setter Property="FontFamily" Value="DokChampa" />
                        <Setter Property="FontSize" Value="15" />
                        <Setter Property="Width" Value="100" />
                    </Style>
                    <Style x:Key="tabGrids">
                        <Setter Property="Grid.Background" Value="#FFE5E5E5" />
                        <Setter Property="Grid.Margin" Value="6,10,10,10" />
                    </Style>
                </TabControl.Resources>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiMotion"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black"  Header="Motion">
                    <!--<TabItem.Header >
                        <TextBlock Text="Motion Setting"  FontSize="12"  Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="LoaderAxisListView" ItemsSource="{Binding Loader.MotionManager.LoaderAxes.ProbeAxisProviders}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled"  >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Label Grid.Row="0" HorizontalAlignment="Center" Content="{Binding AxisType.Value}" FontSize="12" Foreground="White"/>
                                            <StackPanel Orientation="Horizontal" Grid.Row="1">
                                                <Label HorizontalAlignment="Left" Content="HomePos:" FontSize="12" Foreground="White" />
                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Param.HomeOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                    <AutomationProperties.AutomationId>
                                                        <MultiBinding StringFormat="{}{0}_HomePos">
                                                            <Binding Path="AxisType.Value"/>
                                                        </MultiBinding >
                                                    </AutomationProperties.AutomationId>
                                                </TextBox>

                                                <Label HorizontalAlignment="Left" Content="HomeOffset:" FontSize="12" Foreground="White" />
                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Param.ClearedPosition.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                    <AutomationProperties.AutomationId>
                                                        <MultiBinding StringFormat="{}{0}_HomeOffset">
                                                            <Binding Path="AxisType.Value"/>
                                                        </MultiBinding >
                                                    </AutomationProperties.AutomationId>
                                                </TextBox>

                                                <Label HorizontalAlignment="Left" Content="HomeSpeed:" FontSize="12" Foreground="White"/>
                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Param.HommingSpeed.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                    <AutomationProperties.AutomationId>
                                                        <MultiBinding StringFormat="{}{0}_HomeSpeed">
                                                            <Binding Path="AxisType.Value"/>
                                                        </MultiBinding >
                                                    </AutomationProperties.AutomationId>
                                                </TextBox>

                                                <Label HorizontalAlignment="Left" Content="HomeImpulsVelo:" FontSize="12" Foreground="White"/>
                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Param.IndexSearchingSpeed.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                    <AutomationProperties.AutomationId>
                                                        <MultiBinding StringFormat="{}{0}_HomeImpulsVelo">
                                                            <Binding Path="AxisType.Value"/>
                                                        </MultiBinding >
                                                    </AutomationProperties.AutomationId>
                                                </TextBox>

                                                <Label HorizontalAlignment="Left" Content="Speed:" FontSize="12" Foreground="White"/>
                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Param.Speed.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                    <AutomationProperties.AutomationId>
                                                        <MultiBinding StringFormat="{}{0}_Speed">
                                                            <Binding Path="AxisType.Value"/>
                                                        </MultiBinding >
                                                    </AutomationProperties.AutomationId>
                                                </TextBox>

                                                <!--<Label HorizontalAlignment="Left" Content="PickUp Offset:" FontSize="12" Foreground="White"/>
                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White"></TextBox>-->

                                            </StackPanel>
                                        </Grid>

                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiChuck"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="Chuck">
                    <!--<TabItem.Header >
                        <TextBlock Text="Chuck" FontSize="12" Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="ChuckListView" ItemsSource="{Binding Loader.SystemParameter.ChuckModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>

                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" 
                                                   Content="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                                     ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>

                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>

                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <StackPanel Grid.Row="0">
                                                                <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                    <Label.Content>
                                                                        <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                            <Binding Path="CassetteType.Value"/>
                                                                        </MultiBinding>
                                                                    </Label.Content>
                                                                </Label>
                                                            </StackPanel>
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Chuck_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Chuck_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Chuck_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LU Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Chuck_{0}_{1}_LUPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Pick Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Chuck_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiCC"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="CC">
                    <!--<TabItem.Header >
                        <TextBlock Text="CC" FontSize="12" Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="CardChangeListView" ItemsSource="{Binding Loader.SystemParameter.CCModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" Content="{Binding SubstrateSize.Value}" FontSize="12" Foreground="White" />
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CC_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CC_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CC_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LCC Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CC_{0}_{1}_LCCPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Pick Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CC_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiPreAlign"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="PreAlign">
                    <!--<TabItem.Header >
                        <TextBlock Text="PreAlign"  FontSize="12" Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="PreAlignListView" ItemsSource="{Binding Loader.SystemParameter.PreAlignModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Orientation="Vertical" Grid.Column="0">
                                                <Label  VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label HorizontalAlignment="Left" Content="Enable:" FontSize="12" Foreground="White"/>
                                                    <CheckBox HorizontalAlignment="Left" Width="30" IsChecked="{Binding Enable.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                        <AutomationProperties.AutomationId>
                                                            <MultiBinding StringFormat="{}PreAlign_{0}_Enable">
                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                            </MultiBinding >
                                                        </AutomationProperties.AutomationId>
                                                    </CheckBox>
                                                </StackPanel>
                                            </StackPanel>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                <Label.Content>
                                                                    <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                        <Binding Path="SubstrateSize.Value"/>
                                                                        <Binding Path="CassetteType.Value"/>
                                                                    </MultiBinding>
                                                                </Label.Content>
                                                            </Label>
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}PreAlign_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}PreAlign_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}PreAlign_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LU Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}PreAlign_{0}_{1}_LUPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Pick Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}PreAlign_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiCassette"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="Cassette">
                    <!--<TabItem.Header >
                        <TextBlock Text="Cassette"  FontSize="12" Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="CassetteListView" ItemsSource="{Binding Loader.SystemParameter.CassetteModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding Slot1AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                <Label.Content>
                                                                    <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                        <Binding Path="SubstrateSize.Value"/>
                                                                        <Binding Path="CassetteType.Value"/>
                                                                    </MultiBinding>
                                                                </Label.Content>
                                                            </Label>
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Cassette_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Cassette_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Cassette_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LU Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Cassette_{0}_{1}_LUPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Pick Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Cassette_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiBuffer"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="Buffer">
                    <ListView  x:Name="BufferListView" ItemsSource="{Binding Loader.SystemParameter.BufferModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Orientation="Vertical" Grid.Column="0">
                                                <Label  VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label HorizontalAlignment="Left" Content="Enable:" FontSize="12" Foreground="White"/>
                                                    <CheckBox HorizontalAlignment="Left" Width="30" IsChecked="{Binding Enable.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                        <AutomationProperties.AutomationId>
                                                            <MultiBinding StringFormat="{}Buffer_{0}_Enable">
                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                            </MultiBinding >
                                                        </AutomationProperties.AutomationId>
                                                    </CheckBox>
                                                </StackPanel>
                                            </StackPanel>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                <Label.Content>
                                                                    <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                        <Binding Path="SubstrateSize.Value"/>
                                                                        <Binding Path="CassetteType.Value"/>
                                                                    </MultiBinding>
                                                                </Label.Content>
                                                            </Label>
                                                            <StackPanel Orientation="Horizontal" Grid.Row="1">
                                                                <Label HorizontalAlignment="Left" Content="Start POS:" FontSize="12" Foreground="White" />
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.BT.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                    <AutomationProperties.AutomationId>
                                                                        <MultiBinding StringFormat="{}Buffer_{0}_{1}_StartPOS">
                                                                            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                        </MultiBinding >
                                                                    </AutomationProperties.AutomationId>
                                                                </TextBox>

                                                                <Label HorizontalAlignment="Left" Content="PickUp Offset:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                    <AutomationProperties.AutomationId>
                                                                        <MultiBinding StringFormat="{}Buffer_{0}_{1}_PickUpOffset">
                                                                            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                        </MultiBinding >
                                                                    </AutomationProperties.AutomationId>
                                                                </TextBox>

                                                                <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                    <AutomationProperties.AutomationId>
                                                                        <MultiBinding StringFormat="{}Buffer_{0}_{1}_LWPos">
                                                                            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                        </MultiBinding >
                                                                    </AutomationProperties.AutomationId>
                                                                </TextBox>

                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal" Grid.Row="2">

                                                                <Label HorizontalAlignment="Left" Content="Gap Value:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                    <AutomationProperties.AutomationId>
                                                                        <MultiBinding StringFormat="{}Buffer_{0}_{1}_GapValue">
                                                                            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                        </MultiBinding >
                                                                    </AutomationProperties.AutomationId>
                                                                </TextBox>

                                                                <Label HorizontalAlignment="Left" Content="LUC_Back_Pos:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                    <AutomationProperties.AutomationId>
                                                                        <MultiBinding StringFormat="{}Buffer_{0}_{1}_LUCBackPos">
                                                                            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                        </MultiBinding >
                                                                    </AutomationProperties.AutomationId>
                                                                </TextBox>

                                                                <Label HorizontalAlignment="Left" Content="LUC_For_Pos:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                    <AutomationProperties.AutomationId>
                                                                        <MultiBinding StringFormat="{}Buffer_{0}_{1}_LUCForPos">
                                                                            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                            <Binding Path="SubstrateSize.Value"/>
                                                                        </MultiBinding >
                                                                    </AutomationProperties.AutomationId>
                                                                </TextBox>

                                                            </StackPanel>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiFixedTray"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="FixedTray">
                    <!--<TabItem.Header >
                        <TextBlock Text="FixedTray" FontSize="12"  Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="FixedTrayListView" ItemsSource="{Binding Loader.SystemParameter.FixedTrayModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                <Label.Content>
                                                                    <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                        <Binding Path="SubstrateSize.Value"/>
                                                                        <Binding Path="CassetteType.Value"/>
                                                                    </MultiBinding>
                                                                </Label.Content>
                                                            </Label>
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}FixedTray_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}FixedTray_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}FixedTray_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                    <Label HorizontalAlignment="Left" Content="LU Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}FixedTray_{0}_{1}_LUPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="PickUp Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}FixedTray_{0}_{1}_PickUpOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                            <Grid  Grid.Column="2" >
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Visibleflag_CanUseBuffer}" Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Label Grid.Row="0" Content="CanUseBuffer"></Label>
                                                <CheckBox Grid.Row="1" HorizontalAlignment="Center" IsChecked="{Binding CanUseBuffer.Value, Mode=TwoWay}"/>
                                            </Grid>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiINSPTray"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="INSPTray">
                    <!--<TabItem.Header >
                        <TextBlock Text="INSPTray" FontSize="12"  Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="INSPTrayListView" ItemsSource="{Binding Loader.SystemParameter.InspectionTrayModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                <Label.Content>
                                                                    <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                        <Binding Path="SubstrateSize.Value"/>
                                                                        <Binding Path="CassetteType.Value"/>
                                                                    </MultiBinding>
                                                                </Label.Content>
                                                            </Label>
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}INSPTray_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}INSPTray_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}INSPTray_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                    <Label HorizontalAlignment="Left" Content="LU Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}INSPTray_{0}_{1}_LUPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="PickUp Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}INSPTray_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>

                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiFoup"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="Foup">
                    <!--<TabItem.Header >
                        <TextBlock Text="Foup"  FontSize="12" Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="FoupListView" ItemsSource="{Binding Loader.SystemParameter.ScanSensorModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding ScanParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" FontSize="12" Foreground="White" >
                                                                <Label.Content>
                                                                    <MultiBinding Converter="{StaticResource SubstrateConv}">
                                                                        <Binding Path="SubstrateSize.Value"/>
                                                                        <Binding Path="CassetteType.Value"/>
                                                                    </MultiBinding>
                                                                </Label.Content>
                                                            </Label>
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="Start Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding SensorOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Foup_{0}_{1}_StartPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Up Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding UpOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Foup_{0}_{1}_UpPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Down Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding DownOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}Foup_{0}_{1}_DownPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiETCs"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="ETCs">
                    <!--<TabItem.Header >
                        <TextBlock Text="etc.." FontSize="12"  Foreground="Black" />
                    </TabItem.Header>-->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Background="#FF2C2C2F" Grid.Row="0" >
                            <Label HorizontalAlignment="Left" Content="WaferThick:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="ETCs_WaferThick"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.DeviceParameter.CassetteModules[0].WaferThickness.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="WaferGap:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_WaferGap"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.DeviceParameter.CassetteModules[0].SlotSize.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="LU_Gap:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_LUGap"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.ARMModules[1].EndOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="Default_WaferSize:" FontSize="12" Foreground="White"/>
                            <ComboBox AutomationProperties.AutomationId="ETCs_WaferSubstrateType"  Width="70"
                                   VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Foreground="White" FontSize="12"
                                   SelectedValue="{Binding Loader.SystemParameter.DefaultWaferSize.Value ,Mode=TwoWay}"
                                      ItemsSource="{Binding WaferSizeEnums}">
                            </ComboBox>

                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Background="#FF2C2C2F" Grid.Row="1" >
                            <Label HorizontalAlignment="Left" Content="LUD_HeightOffset:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="ETCs_LUD_HeightOffset"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.ARMModules[0].UpOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="nLUU_HeightOffset:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_nLUU_HeightOffset"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.ARMModules[1].UpOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="nLCC_HeightOffset:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_nLCC_HeightOffset"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.CardARMModules[0].UpOffset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Background="#FF2C2C2F" Grid.Row="2" >
                            <Label HorizontalAlignment="Left" Content="CardID__POS__LX:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="ETCs_CardID_POS_LX"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Card_ID_Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="CardID__POS__LZ:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_CardID_POS_LZ"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Card_ID_Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="CardID__POS__LCC:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_CardID_POS_LCC"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Card_ID_Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Background="#FF2C2C2F" Grid.Row="3" >
                            <Label HorizontalAlignment="Left" Content="TCW LoadingAngle:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="ETCs_TCW_LoadingAngle"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.TCW_LoadingAngle.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                            <Label HorizontalAlignment="Left" Content="TCW UnloadingAngle:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="ETCs_TCW_UnloadingAngle"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.TCW_UnloadingAngle.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Background="#FF2C2C2F" Grid.Row="4" >
                        <Label HorizontalAlignment="Left" Content="Cassette Arm LX Interference:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="Cassette_Arm_LX_Interference"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Cassette_Arm_LX_Interference.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                        <Label HorizontalAlignment="Left" Content="Cassette Arm LZ Interference:" FontSize="12" Foreground="White"/>
                            <TextBox AutomationProperties.AutomationId="Cassette_Arm_LZ_Interference"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Cassette_Arm_LZ_Interference.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                        <Label HorizontalAlignment="Left" Content="Cassette Arm LW Interference:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="Cassette_Arm_LW_Interference"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Cassette_Arm_LW_Interference.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>

                        <Label HorizontalAlignment="Left" Content="Cassette Arm LU Interference:" FontSize="12" Foreground="White" />
                            <TextBox AutomationProperties.AutomationId="Cassette_Arm_LU_Interference"
                                     HorizontalAlignment="Left" Width="70" Text="{Binding Loader.SystemParameter.Cassette_Arm_LU_Interference.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                            </TextBox>
                        </StackPanel>

    </Grid>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiCardBuffer"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="CardBuffer">
                    <!--<TabItem.Header >
                        <TextBlock Text="CardBuffer" FontSize="12"  Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="CardBufferListView" ItemsSource="{Binding Loader.SystemParameter.CardBufferModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Orientation="Vertical" Grid.Column="0">
                                                <Label  VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                                <StackPanel Orientation="Horizontal">
                                                    <Label HorizontalAlignment="Left" Content="Enable:" FontSize="12" Foreground="White"/>
                                                    <CheckBox HorizontalAlignment="Left" Width="30" IsChecked="{Binding Enable.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                        <AutomationProperties.AutomationId>
                                                            <MultiBinding StringFormat="{}CardBuffer_{0}_Enable">
                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                            </MultiBinding >
                                                        </AutomationProperties.AutomationId>
                                                    </CheckBox>
                                                </StackPanel>
                                            </StackPanel>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" Content="{Binding SubstrateSize.Value}" FontSize="12" Foreground="White" />
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardBuffer_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardBuffer_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardBuffer_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LCC Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardBuffer_{0}_{1}_LCCPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Pick Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardBuffer_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiCardTray"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="CardTray">
                    <!--<TabItem.Header >
                        <TextBlock Text="CardTray" FontSize="12"  Foreground="Black" />
                    </TabItem.Header>-->
                    <ListView  x:Name="CardTrayListView" ItemsSource="{Binding Loader.SystemParameter.CardBufferTrayModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
                                                                    AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" 
                                       ItemsSource="{Binding AccessParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="2"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" Content="{Binding SubstrateSize.Value}" FontSize="12" Foreground="White" />
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="LX Pos:" FontSize="12" Foreground="White" />
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.LX.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardTray_{0}_{1}_LXPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LZ Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.A.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardTray_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LW Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.W.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardTray_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="LCC Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Position.U.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardTray_{0}_{1}_LCCPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Pick Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding PickupIncrement.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}CardTray_{0}_{1}_PickOffset">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                        <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
                                   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                        <!--
                                <Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
                                   Style="{StaticResource StatusLabelStyle}"  
                                   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
                                   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiRFID"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="RFID">
                    <!--<TabItem.Header >
		<TextBlock Text="Foup"  FontSize="12" Foreground="Black" />
	</TabItem.Header>-->
                    <StackPanel Orientation="Vertical">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ListView Grid.Column="0" x:Name="RFIDListView" ItemsSource="{Binding FoupOP.FoupControllers[0].Service.FoupModule.RFIDModule.RFIDSysParam.RFIDParams}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left" >
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate >
                                        <Border BorderBrush="DimGray" BorderThickness="1">
                                            <Grid>
                                            <Grid.IsEnabled>
                                                <MultiBinding Converter="{StaticResource RFIDProtocolTypeToIsEnableConv}">
                                                    <Binding RelativeSource="{RelativeSource AncestorType={x:Type UserControl}}" Path="DataContext.FoupOP.FoupControllers[0].Service.FoupModule.RFIDModule.RFIDSysParam.RFIDProtocolType"/>
                                                    <Binding Path ="RFIDIndex"/>
                                                </MultiBinding>
                                            </Grid.IsEnabled>
                                                <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
													AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                                    <Grid Grid.Column="1">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="Type" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="0 0 0 2">
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Label HorizontalAlignment="Left" Content="ModuleAttached:" FontSize="12" Foreground="White" />
                                                            <ComboBox AutomationProperties.AutomationId="cmbExistPrefixInRetVal"
                                                                SelectedValue="{Binding ModuleAttached.Value}" Name="ComboBox_ModuleAttached">
                                                                <ComboBox.Items>
                                                                    <System:Boolean>True</System:Boolean>
                                                                    <System:Boolean>False</System:Boolean>
                                                                </ComboBox.Items>

                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}">
                                                                            <i:InvokeCommandAction.CommandParameter>
                                                                                <MultiBinding Converter="{StaticResource RFIDObjectChangeConv}">
                                                                                    <Binding ElementName="ComboBox_ModuleAttached" Path="SelectedItem"/>
                                                                                    <Binding Path ="RFIDIndex"/>
                                                                                </MultiBinding>
                                                                            </i:InvokeCommandAction.CommandParameter>
                                                                        </i:InvokeCommandAction>
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>

                                                            </ComboBox>
                                                                <Label HorizontalAlignment="Left" Content="ModuleCommType:" FontSize="12" Foreground="White"/>
                                                            <ComboBox AutomationProperties.AutomationId="cmbExistPrefixInRetVal"
                                                                SelectedValue="{Binding ModuleCommType.Value}" ItemsSource="{Binding Source={StaticResource getModuleCommType}}" Name="ComboBox_ModuleCommType">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}">
                                                                            <i:InvokeCommandAction.CommandParameter>
                                                                                <MultiBinding Converter="{StaticResource RFIDObjectChangeConv}">
                                                                                    <Binding ElementName="ComboBox_ModuleCommType" Path="SelectedItem"/>
                                                                                    <Binding Path ="RFIDIndex"/>
                                                                                </MultiBinding>
                                                                            </i:InvokeCommandAction.CommandParameter>
                                                                        </i:InvokeCommandAction>
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ComboBox>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                    <Grid Grid.Column="2">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="SERIAL" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="0 0 0 2">
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Label HorizontalAlignment="Left" Content="SerialPort:" FontSize="12" Foreground="White" />
                                                            <ComboBox AutomationProperties.AutomationId="cmbExistPrefixInRetVal"
                                                                SelectedValue="{Binding SerialPort.Value}" ItemsSource="{StaticResource SerialPortList}" Name="ComboBox_SerialPort">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}">
                                                                            <i:InvokeCommandAction.CommandParameter>
                                                                                <MultiBinding Converter="{StaticResource RFIDObjectChangeConv}">
                                                                                    <Binding ElementName="ComboBox_SerialPort" Path="SelectedItem"/>
                                                                                    <Binding Path ="RFIDIndex"/>
                                                                                </MultiBinding>
                                                                            </i:InvokeCommandAction.CommandParameter>
                                                                        </i:InvokeCommandAction>
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ComboBox>
                                                                <Label HorizontalAlignment="Left" Content="BaudRate:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="50" Text="{Binding BaudRate.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="DataBits:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="50" Text="{Binding DataBits.Value ,Mode=TwoWay}" FontSize="12" Foreground="White"></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="StopBitsEnum:" FontSize="12" Foreground="White"/>
                                                            <ComboBox AutomationProperties.AutomationId="cmbExistPrefixInRetVal"
                                                                SelectedValue="{Binding StopBitsEnum.Value}" ItemsSource="{Binding Source={StaticResource getStopBitsEnum}}" Name="ComboBox_StopBitsEnum">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}">
                                                                            <i:InvokeCommandAction.CommandParameter>
                                                                                <MultiBinding Converter="{StaticResource RFIDObjectChangeConv}">
                                                                                    <Binding ElementName="ComboBox_StopBitsEnum" Path="SelectedItem"/>
                                                                                    <Binding Path ="RFIDIndex"/>
                                                                                </MultiBinding>
                                                                            </i:InvokeCommandAction.CommandParameter>
                                                                        </i:InvokeCommandAction>
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ComboBox>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                    <Grid Grid.Column="3">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="TCPIP" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="0 0 2 2">
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Label HorizontalAlignment="Left" Content="Port:" FontSize="12" Foreground="White" />
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Port.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="IP:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="100" Text="{Binding IP.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                </Grid>
                                                <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
				   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                                <!--
				<Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
				   Style="{StaticResource StatusLabelStyle}"  
				   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
				   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            <ListView Grid.Column="1" x:Name="RFIDListView3" ItemsSource="{Binding FoupOP.FoupControllers}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="DimGray" BorderThickness="1">
                                            <Grid>
                                                <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid Grid.Column="0">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="TAG__ID" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="2 0 0 2">
                                                            <Label HorizontalAlignment="Center" Width="120" Height="26" Content="{Binding RFID_ID, Mode=TwoWay}" FontSize="12" Foreground="White"></Label>
                                                        </Border>
                                                    </Grid>
                                                    <Button Grid.Column="1" Content="READ" FontSize="20" Command="{Binding CassetteID_ReadTestCommand}" CommandParameter="{Binding FoupNumber}"/>
                                                </Grid>
                                                <!--<Label Grid.Row="2" ContentStringFormat="Target : {0}" Content="{Binding TargetName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalContentAlignment="Center"
				   Style="{StaticResource ModuleNameLabelStyle}"/>-->
                                                <!--
				<Label Grid.Row="2" Content="{Binding WaferStatus}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" Width="120"
				   Style="{StaticResource StatusLabelStyle}"  
				   Foreground="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"
				   BorderBrush="{Binding WaferStatus, Converter={StaticResource StatusToColorConv}}"/>-->
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            <ListView Grid.Column="2" x:Name="RFIDListView2" ItemsSource="{Binding FoupOP.FoupControllers}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left" 
				  Visibility="{Binding VisibleflagSingle, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate >
                                        <Border BorderBrush="DimGray" BorderThickness="1">
                                            <Grid>
                                                <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid Grid.Column="0">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="State" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="2 0 0 2">
                                                            <Label HorizontalAlignment="Center" Width="120" Height="26" Content="{Binding Service.FoupModule.RFIDModule.CommModule.CurState ,Mode=TwoWay}" FontSize="12" Foreground="White" ></Label>
                                                        </Border>
                                                    </Grid>
                                                    <Button Grid.Column="1" Content="ReInitialize" FontSize="20" Command="{Binding CassetteIDReaderReInitializeCommand}" CommandParameter="{Binding FoupNumber}"/>
                                                </Grid>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            <Border Grid.Column="2" BorderBrush="DimGray" Background="#FF1C1C1F" BorderThickness="1" VerticalAlignment="Top"	Visibility="{Binding VisibleflagMultiple, Converter={StaticResource BooleanToVisibilityConverter}}" Margin="5 2 0 2">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="State" FontSize="12" Foreground="White"/>
                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="2 0 0 2">
                                            <Label HorizontalAlignment="Center" Width="120" Height="26" Content="{Binding FoupOP.RFIDAdapter.CommModule.CurState ,Mode=TwoWay}" FontSize="12" Foreground="White"></Label>
                                        </Border>
                                    </Grid>
                                    <Button Grid.Column="1" Content="ReInitialize" FontSize="20" Command="{Binding CassetteIDReaderReInitializeCommand}" CommandParameter="{Binding FoupNumber}"/>
                                </Grid>
                            </Border>
                        </Grid>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ListView Grid.Column="0" x:Name="RFIDListViewCardID1" ItemsSource="{Binding FoupOP.FoupControllers[0].Service.FoupModule.RFIDModule.RFIDSysParam.ProbeCardRFIDParams}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left" >
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate >
                                        <Border BorderBrush="DimGray" BorderThickness="1">
                                            <Grid>
                                                <Grid Grid.Row="0" Background="#FF1C1C1F">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="CardID"></Label>
                                                    <Grid Grid.Column="1">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="Type" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="0 0 0 2">
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Label HorizontalAlignment="Left" Content="ModuleAttached:" FontSize="12" Foreground="White" />
                                                                <TextBox HorizontalAlignment="Left" Width="50" Text="{Binding ModuleAttached.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="ModuleCommType:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="60" Text="{Binding ModuleCommType.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                    <Grid Grid.Column="2">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="SERIAL" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="0 0 0 2">
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Label HorizontalAlignment="Left" Content="SerialPort:" FontSize="12" Foreground="White" />
                                                                <TextBox HorizontalAlignment="Left" Width="50" Text="{Binding SerialPort.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="BaudRate:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="40" Text="{Binding BaudRate.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="DataBits:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="20" Text="{Binding DataBits.Value ,Mode=TwoWay}" FontSize="12" Foreground="White"></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="StopBitsEnum:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="40" Text="{Binding StopBitsEnum.Value ,Mode=TwoWay}" FontSize="12" Foreground="White"></TextBox>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                    <Grid Grid.Column="3">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="TCPIP" FontSize="12" Foreground="White" />
                                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="0 0 2 2">
                                                            <StackPanel Orientation="Horizontal" >
                                                                <Label HorizontalAlignment="Left" Content="Port:" FontSize="12" Foreground="White" />
                                                                <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Port.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                                <Label HorizontalAlignment="Left" Content="IP:" FontSize="12" Foreground="White"/>
                                                                <TextBox HorizontalAlignment="Left" Width="100" Text="{Binding IP.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                </Grid>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            <Border Grid.Column="1" BorderBrush="DimGray" BorderThickness="1" Margin="5 2 0 2">
                                <Grid Background="#FF1C1C1F" >
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Row="0" HorizontalAlignment="Center" Content="TAG__ID" FontSize="12" Foreground="White" />
                                        <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="2 0 0 0">
                                            <Label HorizontalAlignment="Center" Width="130" Height="26" Content="{Binding RFID_CARD_ID ,Mode=TwoWay}" FontSize="12" Foreground="White" ></Label>
                                        </Border>
                                    </Grid>
                                    <Button Grid.Column="1" Content="READ" FontSize="20" Command="{Binding ReadCardIDTestCommand}"/>
                                </Grid>
                            </Border>
                            <Border Grid.Column="2" BorderBrush="DimGray" BorderThickness="1" Margin="10 2 0 2">
                                <Grid>
                                    <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid Grid.Column="0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Label Grid.Row="0" HorizontalAlignment="Center" Content="State" FontSize="12" Foreground="White"/>
                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1" Margin="2 0 0 2">
                                                <Label HorizontalAlignment="Center" Width="110" Height="26" Content="{Binding RFIDConnectState ,Mode=TwoWay}" FontSize="12" Foreground="White"></Label>
                                            </Border>
                                        </Grid>
                                        <Button Grid.Column="1" Content="ReInitialize" FontSize="20" Command="{Binding RFIDforCardIDReInitializeCommand}"/>
                                    </Grid>
                                </Grid>
                            </Border>
                        </Grid>
                    </StackPanel>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiBarcodeReader"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="BarcodeReader">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ListView Grid.Column="0" x:Name="BCDListView" ItemsSource="{Binding FoupOP.FoupControllers[0].Service.FoupModule.BarcodeReaderModule.BarcodeReaderSysParam.BarcodeReaderParams}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left" >
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemTemplate>
                                <DataTemplate >
                                    <Border BorderBrush="DimGray" BorderThickness="1">
                                        <Grid>
                                            <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, 
													AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                                <Grid Grid.Column="1">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Label Grid.Row="0" HorizontalAlignment="Center" Content="Type" FontSize="12" Foreground="White" />
                                                    <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                        <StackPanel Orientation="Horizontal" >
                                                            <Label HorizontalAlignment="Left" Content="ModuleAttached:" FontSize="12" Foreground="White" />
                                                            <ComboBox AutomationProperties.AutomationId="cmbExistPrefixInRetVal"
                                                                SelectedValue="{Binding ModuleAttached.Value}" Name="ComboBox_ModuleAttached">
                                                                <ComboBox.Items>
                                                                    <System:Boolean>True</System:Boolean>
                                                                    <System:Boolean>False</System:Boolean>
                                                                </ComboBox.Items>

                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}">
                                                                            <i:InvokeCommandAction.CommandParameter>
                                                                                <MultiBinding Converter="{StaticResource BCDObjectChangeConv}">
                                                                                    <Binding ElementName="ComboBox_ModuleAttached" Path="SelectedItem"/>
                                                                                    <Binding Path ="ModuleIndex"/>
                                                                                </MultiBinding>
                                                                            </i:InvokeCommandAction.CommandParameter>
                                                                        </i:InvokeCommandAction>
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ComboBox>
                                                            <Label  HorizontalAlignment="Left" Content="ModuleCommType:" FontSize="12" Foreground="White"/>
                                                            <ComboBox AutomationProperties.AutomationId="cmbExistPrefixInRetVal"
                                                                SelectedValue="{Binding ModuleCommType.Value}" ItemsSource="{Binding Source={StaticResource getModuleCommTypeBCD}}" Name="ComboBox_ModuleCommType">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="SelectionChanged">
                                                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}">
                                                                            <i:InvokeCommandAction.CommandParameter>
                                                                                <MultiBinding Converter="{StaticResource BCDObjectChangeConv}">
                                                                                    <Binding ElementName="ComboBox_ModuleCommType" Path="SelectedItem"/>
                                                                                    <Binding Path ="ModuleIndex"/>
                                                                                </MultiBinding>
                                                                            </i:InvokeCommandAction.CommandParameter>
                                                                        </i:InvokeCommandAction>
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ComboBox>
                                                        </StackPanel>
                                                    </Border>
                                                </Grid>
                                                <Grid Grid.Column="2">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Label Grid.Row="0" HorizontalAlignment="Center" Content="TCPIP" FontSize="12" Foreground="White" />
                                                    <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                        <StackPanel Orientation="Horizontal" >
                                                            <Label HorizontalAlignment="Left" Content="Port:" FontSize="12" Foreground="White" />
                                                            <TextBox HorizontalAlignment="Left" Width="70" Text="{Binding Port.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                            <Label HorizontalAlignment="Left" Content="IP:" FontSize="12" Foreground="White"/>
                                                            <TextBox HorizontalAlignment="Left" Width="100" Text="{Binding IP.Value ,Mode=TwoWay}" FontSize="12" Foreground="White" ></TextBox>
                                                        </StackPanel>
                                                    </Border>
                                                </Grid>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                        <ListView Grid.Column="1" x:Name="BCDListView2" ItemsSource="{Binding FoupOP.FoupControllers}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left" >
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemTemplate>
                                <DataTemplate >
                                    <Border BorderBrush="DimGray" BorderThickness="1">
                                        <Grid>
                                            <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid Grid.Column="0">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Label Grid.Row="0" HorizontalAlignment="Center" Content="BCD_ID" FontSize="12" Foreground="White" />
                                                    <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                        <Label HorizontalAlignment="Center" Width="120" Content="{Binding BCD_ID ,Mode=TwoWay}" FontSize="12" Foreground="White" ></Label>
                                                    </Border>
                                                </Grid>
                                                <Button Grid.Column="1" Content="READ" FontSize="20" Command="{Binding CassetteID_ReadTestCommand}" CommandParameter="{Binding FoupNumber}"/>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                        <ListView Grid.Column="2" x:Name="BCDListView3" ItemsSource="{Binding FoupOP.FoupControllers}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalAlignment="Left">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemTemplate>
                                <DataTemplate >
                                    <Border BorderBrush="DimGray" BorderThickness="1">
                                        <Grid>
                                            <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid Grid.Column="0">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Label Grid.Row="0" HorizontalAlignment="Center" Content="State" FontSize="12" Foreground="White" />
                                                    <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                        <Label HorizontalAlignment="Center" Width="120" Content="{Binding Service.FoupModule.BarcodeReaderModule.CommModule.CurState ,Mode=TwoWay}" FontSize="12" Foreground="White" ></Label>
                                                    </Border>
                                                </Grid>
                                                <Button Grid.Column="1" Content="ReInitialize" FontSize="20" Command="{Binding CassetteIDReaderReInitializeCommand}" CommandParameter="{Binding FoupNumber}"/>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </MahAppsControls:MetroTabItem>
                <MahAppsControls:MetroTabItem AutomationProperties.AutomationId="tiOCR"
                                              Background="DimGray" BorderThickness="1" BorderBrush="Black" Header="OCR">
                    <ListView  x:Name="OCRListView" ItemsSource="{Binding Loader.SystemParameter.CognexOCRModules}" Background="#FF2C2C2F" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate >
                                <Border BorderBrush="DimGray" BorderThickness="1">
                                    <Grid>
                                        <Grid Grid.Row="0" Background="#FF1C1C1F" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}, Converter={StaticResource IndexConverter}}"></Label>
                                            <ListView Grid.Column="1"  HorizontalAlignment="Center" x:Name="SlotListView" ItemsSource="{Binding SubchuckMotionParams}" Background="#FF1C1C1F" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <UniformGrid Columns="3"></UniformGrid>
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <Label Grid.Row="0" HorizontalAlignment="Center" Content="{Binding SubstrateSize.Value}" FontSize="12" Foreground="White" />
                                                            <Border BorderBrush="White" BorderThickness="1" Grid.Row="1">
                                                                <StackPanel Orientation="Horizontal" >
                                                                    <Label HorizontalAlignment="Left" Content="Subchuck X Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="58" Text="{Binding SubchuckXCoord.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}OCR_{0}_{1}_LZPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="Subchuck Y Pos:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="58" Text="{Binding SubchuckYCoord.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}OCR_{0}_{1}_LWPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                    <Label HorizontalAlignment="Left" Content="OCR Angle Offset:" FontSize="12" Foreground="White"/>
                                                                    <TextBox HorizontalAlignment="Left" Width="58" Text="{Binding SubchuckAngle_Offset.Value ,Mode=TwoWay}" FontSize="12" Foreground="White">
                                                                        <AutomationProperties.AutomationId>
                                                                            <MultiBinding StringFormat="{}_{0}_{1}_LCCPos">
                                                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorLevel=2, AncestorType={x:Type ListViewItem}}" Converter="{StaticResource IndexConverter}"/>
                                                                                <Binding Path="SubstrateSize.Value"/>
                                                                            </MultiBinding >
                                                                        </AutomationProperties.AutomationId>
                                                                    </TextBox>
                                                                </StackPanel>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </MahAppsControls:MetroTabItem>
            </MahAppsControls:MetroAnimatedSingleRowTabControl>


            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Button Grid.Column="1" Command="{Binding SaveParamCommand}" CommandParameter="false" Content="Save" Foreground="Black" BorderBrush="Black" BorderThickness="2" HorizontalAlignment="Center"
                        FontSize="30" Background="White" Width="100" Height="100" />

                <Button Grid.Column="2" Command="{Binding Add13slotParamCommand}" CommandParameter="false" Foreground="Black" BorderBrush="Black" BorderThickness="2" HorizontalAlignment="Right"
                        FontSize="15" Background="White" Width="160" Height="40">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Visibility" Value="Visible"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Visibleflag_AddParam}" Value="false">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="Add 13slot column" VerticalAlignment="Center" Margin="5"/>
                        <Path Data="M5,0 L5,10 M0,5 L10,5" Width="10" Height="10" VerticalAlignment="Center" Stroke="Black" StrokeThickness="3" Margin="5"/>
                    </StackPanel>
                </Button>
            </Grid>
        </StackPanel>

    </Grid>
</UserControl>