<Controls:MetroWindow x:Class="LoaderSystem.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LoaderSystem"
        xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:vc="clr-namespace:ValueConverters;assembly=ValueConverters"
        xmlns:prvm="clr-namespace:ProberViewModel;assembly=ProberViewModel"
        xmlns:vm="clr-namespace:ProberViewModel.View.LoaderLogIntegratedViewer;assembly=ProberViewModel"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Loader System"
        Background="#0F0F0F" GlowBrush="Black"
        Closing="Window_Closing" ShowCloseButton="false"
        Deactivated="MetroWindow_Deactivated"
        Activated="MetroWindow_Activated" Loaded="MetroWindow_Loaded" 
        AllowsTransparency="True" WindowStyle="None" BorderBrush="Black" BorderThickness="5"
        MaxHeight="1080" MaxWidth="1920">
    
    <Controls:MetroWindow.Resources>

        <vc:BoolToBrushConverter x:Key="BoolToBrushConv" TrueValueBrush="LimeGreen" FalseValueBrush="White"/>
        <SolidColorBrush x:Key="BlackColorBrush" Color="#00000000"/>

        <!--<DataTemplate x:Key="HeaderTemplate1"
              x:Shared="False">
            <DockPanel x:Name="dpHeader"
               Margin="10,25,10,10"
               VerticalAlignment="Center"
               LastChildFill="True">
                
                <Button x:Name="nav"
                Command="{Binding RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}, Path=CloseCommand, Mode=OneWay}"
                DockPanel.Dock="Left"
                Style="{DynamicResource MetroCircleButtonStyle}"
                Visibility="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Controls:Flyout}}, Path=CloseButtonVisibility}"
                Height="40"
                Width="40"
                FontFamily="Segoe UI Symbol"
                Foreground="{Binding RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}, Path=Foreground}"
                FontSize="16"
                VerticalAlignment="Bottom">
                    
                    --><!--<i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <Actions:SetFlyoutOpenAction TargetObject="{Binding RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}}" Value="False" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>--><!--
                    
                    <Rectangle Width="20"
                       Height="15"
                       Fill="{Binding RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}, Path=Foreground}">
                        <Rectangle.OpacityMask>
                            <VisualBrush Stretch="Fill">
                                <VisualBrush.Visual>
                                    <Canvas Width="48"
                                    Height="48"
                                    Clip="F1 M 0,0L 48,0L 48,48L 0,48L 0,0"
                                    UseLayoutRounding="False">
                                        <Path Width="25"
                                      Height="18"
                                      Canvas.Left="12"
                                      Canvas.Top="15"
                                      Stretch="Fill"
                                      Fill="Black"
                                      Data="F1 M 12,22L 12,26L 28.25,26L 21,33L 27.5,33L 37,24L 27.5,15L 21,15L 28.25,22L 12,22 Z " />
                                    </Canvas>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Rectangle.OpacityMask>
                    </Rectangle>
                </Button>
                
                <TextBlock Text="{Binding}"
                   x:Name="PART_BackButton"
                   Visibility="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Controls:Flyout}}, Path=TitleVisibility}"
                   FontSize="{StaticResource FlyoutHeaderFontSize}"
                   Margin="15,0,0,0"
                   VerticalAlignment="Center" />
                
            </DockPanel>
            
            <DataTemplate.Triggers>
                
                <DataTrigger Binding="{Binding Position, RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}}"
                     Value="Right">
                    <Setter TargetName="nav"
                    Property="LayoutTransform">
                        <Setter.Value>
                            <RotateTransform Angle="45" />
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                
                <DataTrigger Binding="{Binding Position, RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}}"
                     Value="Left">
                    <Setter TargetName="nav"
                    Property="DockPanel.Dock"
                    Value="Right" />
                    <Setter TargetName="PART_BackButton"
                    Property="TextAlignment"
                    Value="Right" />
                    <Setter TargetName="PART_BackButton"
                    Property="Margin"
                    Value="0,0,15,0" />
                    <Setter TargetName="nav"
                    Property="LayoutTransform">
                        <Setter.Value>
                            <ScaleTransform ScaleX="-1" />
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                
                <DataTrigger Binding="{Binding Position, RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}}"
                     Value="Top">
                    <Setter TargetName="dpHeader"
                    Property="Margin"
                    Value="10" />
                    <Setter TargetName="nav"
                    Property="LayoutTransform">
                        <Setter.Value>
                            <RotateTransform Angle="-90" />
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                
                <DataTrigger Binding="{Binding Position, RelativeSource={RelativeSource AncestorType={x:Type Controls:Flyout}}}"
                     Value="Bottom">
                    <Setter TargetName="dpHeader"
                    Property="Margin"
                    Value="10" />
                    <Setter TargetName="nav"
                    Property="LayoutTransform">
                        <Setter.Value>
                            <RotateTransform Angle="90" />
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>-->
        
    </Controls:MetroWindow.Resources>

    <Controls:MetroWindow.Flyouts>

        <Controls:FlyoutsControl>

            <Controls:Flyout AutomationProperties.AutomationId="LoaderFlyout"
                             Theme="Dark" TitleVisibility="Hidden" 
                             Position="Left" CloseButtonVisibility="Hidden"
                             Width="420" 
                             IsOpen="{Binding FlyoutIsOpen, Mode=TwoWay}">

                <Grid>
                    <ContentControl Content="{Binding MainMenuView}"/>
                    <prvm:FilterPanel x:Name="FilterPanelControl2" DataContext="{Binding VMFilterPanel}"/>
                </Grid>

            </Controls:Flyout>

        </Controls:FlyoutsControl>

    </Controls:MetroWindow.Flyouts>

    <!--<Controls:MetroWindow.RightWindowCommands>
        <Controls:WindowCommands>
            <ToggleButton Content="Layers" IsChecked="{Binding ElementName=yourMahAppFlyout, Path=IsOpen}" Cursor="Hand"/>
        </Controls:WindowCommands>
    </Controls:MetroWindow.RightWindowCommands>-->
    <materialDesign:DialogHost x:Name="m_dialogHost" Identifier="dialogHost" DialogTheme="Dark">
        <local:DrawerHostEx x:Name="LoaderDrawer">
            <local:DrawerHostEx.TopDrawerContent>
                <Grid Height="1050" Background="Black">
                    <Grid Grid.Row="0">
                        <vm:LoaderLogIntegratedViewer Grid.Row="0" x:Name="DockLogView" VerticalAlignment="Stretch" Margin="8,4"/>
                        <!--<vm:LoaderLogIntegratedView Grid.Row="0" x:Name="DockLogView" VerticalAlignment="Stretch" Margin="8,4"/>-->
                    </Grid>
                </Grid>
            </local:DrawerHostEx.TopDrawerContent>
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition  />
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition />
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Grid.Column="1">
                    <Grid>
                        <ContentControl DataContext="{Binding ''}" Content="{Binding MainTopBarView}" />
                    </Grid>
                </Border>

                <!-- Main Screen -->
                    <Grid Grid.Row="{Binding MainViewRow}" Grid.RowSpan ="{Binding MainViewRowSpan}" Grid.ColumnSpan="2" Width="{Binding MainViewWidth}" Height="{Binding MainViewHeight}" >
                    <Border 
                        Margin="4" 
                        BorderBrush="#FFd6d9f4" 
                        BorderThickness="0.5" 
                        CornerRadius="1" >
                        <Grid>
                            <ContentControl DataContext="{Binding ''}" Content="{Binding MainScreenView}"/>
                        </Grid>
                    </Border>
                </Grid>
            <prvm:FilterPanel x:Name="FilterPanelControl" DataContext="{Binding VMFilterPanel}" Grid.RowSpan="4" Grid.ColumnSpan="3"/>
                <!--<menu:LoaderMainMenuControl Grid.Column="0" Grid.Row="0" Margin="4,4,0,4" 
            HorizontalAlignment="Left"
            DataContext="{Binding MainMenuVM}" />-->
        </Grid>
        </local:DrawerHostEx>
    </materialDesign:DialogHost>

    
    
</Controls:MetroWindow>
